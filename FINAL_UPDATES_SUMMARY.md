# โ ููุฎุต ุงูุชุญุฏูุซุงุช ุงูููุงุฆูุฉ - Public API

## ๐ ุงูุชุนุฏููุงุช ุงููุทููุจุฉ

ุชู ุชูููุฐ ุงูุชุนุฏููุงุช ุงูุชุงููุฉ ุจูุงุกู ุนูู ุทูุจ ุงูุนููู:

### 1. โ ุฅุฒุงูุฉ ููุน ุงูุชูุฑุงุฑ
- **ุงูุณุจุจ:** ุงูุณูุงุญ ุจุชุณุฌูู ููุณ ุฑูู ุงูุฌูุงู ุฃูุซุฑ ูู ูุฑุฉ
- **ุงูุชุนุฏููุงุช:**
  - โ ุฅุฒุงูุฉ `unique:clients,phone` ูู Validation
  - โ ุฅุฒุงูุฉ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุชูุฑุงุฑ ูู Controller
  - โ ุชุญุฏูุซ ุฑุณุงุฆู ุงูุฎุทุฃ

### 2. โ ุฅุถุงูุฉ Rate Limiting
- **ุงูุญุฏ:** 60 ุทูุจ ูู ุงูุฏูููุฉ ููู API Key
- **ุงูุชุทุจูู:** `throttle:60,1` middleware
- **ุงููููุน:** `routes/api.php`

---

## ๐ ุงููููุงุช ุงูููุนุฏูุฉ

### 1. `app/Http/Requests/Api/Public/StoreLeadRequest.php`
```php
// ูุจู ุงูุชุนุฏูู
'phone' => [
    'required',
    'string',
    'regex:/^(\+966|00966|966|05)[0-9]{8,9}$/',
    'unique:clients,phone'  // โ ุชู ุงูุฅุฒุงูุฉ
],

// ุจุนุฏ ุงูุชุนุฏูู
'phone' => [
    'required',
    'string',
    'regex:/^(\+966|00966|966|05)[0-9]{8,9}$/',
    // Note: Duplicate phone numbers are allowed
],
```

### 2. `app/Http/Controllers/Api/Public/LeadController.php`
```php
// ูุจู ุงูุชุนุฏูู
public function store(StoreLeadRequest $request): JsonResponse
{
    try {
        // ... code
    } catch (\Illuminate\Database\QueryException $e) {
        // Handle duplicate phone number โ ุชู ุงูุฅุฒุงูุฉ
    }
}

// ุจุนุฏ ุงูุชุนุฏูู
public function store(StoreLeadRequest $request): JsonResponse
{
    // ... code (ุจุฏูู try-catch)
}
```

### 3. `routes/api.php`
```php
// ูุจู ุงูุชุนุฏูู
Route::prefix('public/v1')->middleware('api.key')->group(function () {
    Route::post('leads', [LeadController::class, 'store']);
});

// ุจุนุฏ ุงูุชุนุฏูู
Route::prefix('public/v1')->middleware(['api.key', 'throttle:60,1'])->group(function () {
    // Rate Limit: 60 requests per minute per API key
    Route::post('leads', [LeadController::class, 'store']);
});
```

---

## ๐ฏ ุงูุณููู ุงูุฌุฏูุฏ

### ุงูุชุณุฌููุงุช ุงูููุฑุฑุฉ
- โ **ููุณูุญ** ุจุชุณุฌูู ููุณ ุฑูู ุงูุฌูุงู ุนุฏุฉ ูุฑุงุช
- โ ูู ุชุณุฌูู ูููุดุฆ ุณุฌู ุนููู ุฌุฏูุฏ ูููุตู
- โ ูุง ุชูุฌุฏ ุฑุณุงุฆู ุฎุทุฃ ููุฃุฑูุงู ุงูููุฑุฑุฉ

### Rate Limiting
- โ **60 ุทูุจ ูู ุงูุฏูููุฉ** ููู API Key
- โ ุฅุฐุง ุชุฌุงูุฒ ุงูุญุฏ: ุงุณุชุฌุงุจุฉ `429 Too Many Requests`
- โ ูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ ูู ุฏูููุฉ

---

## ๐ ูุซุงู ุนูู ุงูุณููู

### ุงูุณููุงุฑูู: ุชุณุฌูู ููุณ ุงูุฑูู 3 ูุฑุงุช

```bash
# ุงูุทูุจ ุงูุฃูู
POST /api/public/v1/leads
{
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "phone": "0501234567",
  "source": "contact_form"
}
# ุงููุชูุฌุฉ: โ 201 Created - lead_id: 1

# ุงูุทูุจ ุงูุซุงูู (ููุณ ุงูุฑูู)
POST /api/public/v1/leads
{
  "name": "ุฃุญูุฏ ุนูู",
  "phone": "0501234567",
  "source": "landing_page"
}
# ุงููุชูุฌุฉ: โ 201 Created - lead_id: 2

# ุงูุทูุจ ุงูุซุงูุซ (ููุณ ุงูุฑูู)
POST /api/public/v1/leads
{
  "name": "ูุญูุฏ ุฃุญูุฏ",
  "phone": "0501234567",
  "source": "website_form"
}
# ุงููุชูุฌุฉ: โ 201 Created - lead_id: 3
```

**ุงููุชูุฌุฉ:** 3 ุณุฌูุงุช ูููุตูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูููุง ุจููุณ ุฑูู ุงูุฌูุงู.

---

## ๐งช ุงุฎุชุจุงุฑ Rate Limiting

```bash
# ุฅุฑุณุงู 61 ุทูุจ ูู ุฏูููุฉ ูุงุญุฏุฉ

# ุงูุทูุจุงุช 1-60: โ 201 Created
# ุงูุทูุจ 61: โ 429 Too Many Requests

# ุงูุงุณุชุฌุงุจุฉ ููุทูุจ 61:
{
  "message": "Too Many Attempts.",
  "exception": "Illuminate\\Http\\Exceptions\\ThrottleRequestsException"
}

# ุจุนุฏ ุฏูููุฉ ูุงุญุฏุฉ: โ ูุนูุฏ ุงูุนุฏุงุฏ ุฅูู ุงูุตูุฑ
```

---

## ๐ ูุง ูุฌุจ ุฅุจูุงุบ ุงููุจุฑูุฌ ุงูุฎุงุฑุฌู ุจู

### ุงูุชุญุฏูุซุงุช ุงูุฑุฆูุณูุฉ:

1. **ุงูุชุณุฌููุงุช ุงูููุฑุฑุฉ:**
   - โ ูููู ุชุณุฌูู ููุณ ุฑูู ุงูุฌูุงู ุนุฏุฉ ูุฑุงุช
   - โ ูู ูุญุตู ุนูู ุฎุทุฃ "ุฑูู ุงูุฌูุงู ูุณุฌู ูุณุจูุงู"

2. **Rate Limiting:**
   - โ๏ธ ุงูุญุฏ: 60 ุทูุจ ูู ุงูุฏูููุฉ
   - โ๏ธ ุฅุฐุง ุชุฌุงูุฒ ุงูุญุฏ: ุณูุญุตู ุนูู `429 Too Many Requests`
   - โ ูุฌุจ ูุนุงูุฌุฉ ูุฐุง ุงูุฎุทุฃ ูู ุงูููุฏ

---

## ๐ ุงูุชูุซูู ุงูููุญุฏุซ

### ุงููููุงุช ุงูููุญุฏุซุฉ:
- โ `RESPONSE_TO_DEVELOPER.md` - ุงูุฑุฏ ุงูููุงุฆู ูููุจุฑูุฌ
- โ `DOCS_PUBLIC_API_INTEGRATION.md` - ุงูุชูุซูู ุงูุดุงูู
- โ `PUBLIC_API_README.md` - ุงูุฏููู ุงูุณุฑูุน

### ูุง ุชู ุชุญุฏูุซู:
- โ ุฅุฒุงูุฉ ุงูุฅุดุงุฑุฉ ูููุน ุงูุชูุฑุงุฑ
- โ ุฅุถุงูุฉ ูุนูููุงุช Rate Limiting
- โ ุชุญุฏูุซ ุฃูุซูุฉ ุงูุฃุฎุทุงุก
- โ ุชุญุฏูุซ ุฌุฏูู ุฑููุฒ ุงูุญุงูุฉ

---

## โ ุงูุฎูุงุตุฉ

| ุงูููุฒุฉ | ุงูุญุงูุฉ ุงูุณุงุจูุฉ | ุงูุญุงูุฉ ุงูุญุงููุฉ |
|--------|----------------|-----------------|
| **ููุน ุงูุชูุฑุงุฑ** | โ ููุนูู | โ ูุนุทูู |
| **Rate Limiting** | โ ุบูุฑ ููุนูู | โ ููุนูู (60/ุฏูููุฉ) |
| **ุงูุชุณุฌููุงุช ุงูููุฑุฑุฉ** | โ ูุฑููุถุฉ | โ ูุณููุญุฉ |

---

**ุชู ุงูุชุญุฏูุซ ุจูุงุณุทุฉ:** Antigravity AI  
**ุงูุชุงุฑูุฎ:** 2026-01-24  
**ุงูููุช:** 16:45
