# โ ููุฎุต ุงููุดุฑูุน: Public API ูุฑุจุท ููุงุฐุฌ ุงููููุน ูุน CRM

## ๐ ุงููุทููุจ ุงูุฃุตูู

ุชู ุทูุจ ุฅูุดุงุก API Endpoint ูุฑุจุท ููุงุฐุฌ ุงููููุน ุงูุฅููุชุฑููู (Contact Forms & Landing Pages) ูุน ูุธุงู CRMุ ุจุญูุซ ูุชู ุชุณุฌูู ุงูุนููุงุก ุชููุงุฆูุงู ุนูุฏ ุฅุฑุณุงู ุจูุงูุงุชูู ูู ุงููููุน.

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. **Backend Implementation** (Laravel)

#### Controllers
- โ `app/Http/Controllers/Api/Public/LeadController.php`
  - ูุนุงูุฌุฉ ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ูู ุงูููุงุฐุฌ
  - ุฅูุดุงุก ุงูุนููุงุก ุงูุฌุฏุฏ (Leads)
  - ุฅุถุงูุฉ ุงูุชุนูููุงุช ุงูุชููุงุฆูุฉ ููุฑุณุงุฆู

#### Validation
- โ `app/Http/Requests/Api/Public/StoreLeadRequest.php`
  - ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
  - ุชูุณูู ุฃุฑูุงู ุงูุฌูุงู ุชููุงุฆูุงู
  - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

#### Middleware
- โ `app/Http/Middleware/ValidateApiKey.php`
  - ูุตุงุฏูุฉ API Key
  - ุญูุงูุฉ ุงูู Endpoint ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ

#### Routes
- โ `routes/api.php` (ุชู ุงูุชุญุฏูุซ)
  - `POST /api/public/v1/leads`
  - ูุน middleware ููู API Key

#### Configuration
- โ `config/services.php` (ุชู ุงูุชุญุฏูุซ)
  - ุฅุถุงูุฉ `api_keys.public` configuration
- โ `.env.example` (ุชู ุงูุชุญุฏูุซ)
  - ุฅุถุงูุฉ `PUBLIC_API_KEYS` variable
- โ `bootstrap/app.php` (ุชู ุงูุชุญุฏูุซ)
  - ุชุณุฌูู `api.key` middleware

#### Database
- โ `database/seeders/WebsiteFormsSourceSeeder.php`
  - ุฅุถุงูุฉ ูุตุงุฏุฑ ุงูููุงุฐุฌ (ูููุฐุฌ ุงุชุตู ุจูุงุ ุตูุญุฉ ุงููุจูุทุ ูููุฐุฌ ุงููููุน)
  - **ุชู ุงูุชุดุบูู ุจูุฌุงุญ โ**

---

### 2. **Documentation** (ุงูุชูุซูู)

#### ูููุจุฑูุฌ ุงูุฎุงุฑุฌู
- โ `DOCS_PUBLIC_API_INTEGRATION.md`
  - ุชูุซูู ุดุงูู ุจุงูุนุฑุจูุฉ
  - ุดุฑุญ ุงูู Endpoint ูุงููุตุงุฏูุฉ
  - ุฃูุซูุฉ ุจู cURL, JavaScript, PHP
  - ุฌููุน ุงูุงุณุชุฌุงุจุงุช ุงููุชููุนุฉ
  - ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

#### ูููุฑูู ุงูุชููู
- โ `DOCS_PUBLIC_API_INTERNAL.md`
  - ุงูุจููุฉ ุงูุชูููุฉ ุงููุงููุฉ
  - Flow Diagram
  - ุชูุงุตูู ุงููููุงุช ุงููููุดุฃุฉ
  - ุฏููู ุงูุงุฎุชุจุงุฑ
  - ุงููุฑุงูุจุฉ ูุงูุชุชุจุน

#### ุฏููู ุณุฑูุน
- โ `PUBLIC_API_README.md`
  - ููุฎุต ุณุฑูุน ููุชูุนูู
  - ุฎุทูุงุช ุงูุฅุนุฏุงุฏ
  - ุงูุญููู ุงููุทููุจุฉ
  - ุงูููุฒุงุช ูุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

---

### 3. **Examples & Testing**

#### ุฃูุซูุฉ ุงูุจุฑูุฌุฉ
- โ `examples/public-api-integration.js`
  - ุฃูุซูุฉ Vanilla JavaScript
  - ุฃูุซูุฉ jQuery
  - ุฃูุซูุฉ React Hook
  - ุฃูุซูุฉ Vue.js Component
  - Helper Functions (Validation, Formatting)

#### Postman Collection
- โ `crm_wakeel_postman_collection.json` (ุชู ุงูุชุญุฏูุซ)
  - 3 ุฃูุซูุฉ ุฌุงูุฒุฉ:
    1. Submit Lead (Contact Form)
    2. Submit Lead (Landing Page)
    3. Submit Lead (Minimal Data)

---

## ๐ ุงูุฃูุงู ุงูููุทุจู

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ุงููุตู |
|--------|--------|------|
| **API Key Authentication** | โ | ููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ |
| **Request Validation** | โ | ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช |
| **Phone Normalization** | โ | ุชูุญูุฏ ุตูุบุฉ ุงูุฃุฑูุงู (+966) |
| **Unique Constraint** | โ | ููุน ุชุณุฌูู ููุณ ุงูุฑูู ูุฑุชูู |
| **Error Handling** | โ | ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุงุญุชุฑุงูู |
| **HTTPS** | โ๏ธ | ูุฌุจ ุชูุนููู ูู Production |

---

## ๐ ุงูุญููู ุงููุฏุนููุฉ

### ุงูุญููู ุงููุทููุจุฉ (Required)
- โ `name` - ุงูุงุณู ุงููุงูู (3-255 ุญุฑู)
- โ `phone` - ุฑูู ุงูุฌูุงู ุงูุณุนูุฏู
- โ `source` - ูุตุฏุฑ ุงููููุฐุฌ (`contact_form`, `landing_page`, `website_form`)

### ุงูุญููู ุงูุงุฎุชูุงุฑูุฉ (Optional)
- โ `email` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- โ `company` - ุงุณู ุงูุดุฑูุฉ
- โ `address` - ุงูุนููุงู
- โ `subject` - ููุถูุน ุงูุฑุณุงูุฉ (ูููุฐุฌ ุงุชุตู ุจูุง)
- โ `message` - ูุต ุงูุฑุณุงูุฉ (ูููุฐุฌ ุงุชุตู ุจูุง)

---

## ๐ฏ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

1. **ุชุณุฌูู ุชููุงุฆู ููุนููุงุก**
   - ูุชู ุฅูุดุงุก ุณุฌู ุนููู ุฌุฏูุฏ ููุฑุงู
   - ุงูุญุงูุฉ ุงูุงูุชุฑุงุถูุฉ: "ุฌุฏูุฏ"
   - ุงูุชูููู ุงูุงูุชุฑุงุถู: "warm"
   - ุงูุฃููููุฉ ุงูุงูุชุฑุงุถูุฉ: "medium"

2. **ุชุชุจุน ุงููุตุฏุฑ**
   - ุชุญุฏูุฏ ูุตุฏุฑ ูู ุนููู (Contact Form vs Landing Page)
   - ูุณุงุนุฏ ูู ุชุญููู ูุนุงููุฉ ูู ูููุฐุฌ

3. **ุญูุธ ุงูุฑุณุงุฆู**
   - ุฅุฐุง ุฃุฑุณู ุงูุนููู ุฑุณุงูุฉ/ููุถูุนุ ูุชู ุญูุธูุง ูู Comment
   - ูุฑุชุจุทุฉ ุจุงูุนููู ูุจุงุดุฑุฉ

4. **ุชูุณูู ุชููุงุฆู**
   - ุชุญููู ุฃุฑูุงู ุงูุฌูุงู ุฅูู ุตูุบุฉ ููุญุฏุฉ (+966)
   - ูุฏุนู ุฌููุน ุงูุตูุบ (05, +966, 00966, 966)

5. **ููุน ุงูุชูุฑุงุฑ**
   - ูุง ูููู ุชุณุฌูู ููุณ ุฑูู ุงูุฌูุงู ูุฑุชูู
   - ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู

---

## ๐ ูุง ูุฌุจ ุฅุฑุณุงูู ูููุจุฑูุฌ ุงูุฎุงุฑุฌู

### ุงููููุงุช
1. โ `DOCS_PUBLIC_API_INTEGRATION.md`
2. โ `examples/public-api-integration.js` (ุงุฎุชูุงุฑู)
3. โ `crm_wakeel_postman_collection.json` (ุงุฎุชูุงุฑู)

### ุงููุนูููุงุช
1. **API Endpoint:**
   ```
   POST https://your-domain.com/api/public/v1/leads
   ```

2. **API Key:**
   ```
   ูู ุจุชูููุฏู ุจุงุณุชุฎุฏุงู:
   php artisan tinker
   >>> Str::random(40)
   
   ุซู ุฃุถูู ูู .env:
   PUBLIC_API_KEYS=generated_key_here
   ```

3. **Headers ุงููุทููุจุฉ:**
   ```
   Content-Type: application/json
   X-API-Key: your_api_key_here
   ```

4. **ูุซุงู ุนูู ุงูุทูุจ:**
   ```json
   {
     "name": "ุฃุญูุฏ ูุญูุฏ",
     "phone": "0501234567",
     "email": "ahmed@example.com",
     "subject": "ุงุณุชูุณุงุฑ",
     "message": "ุฃุฑุบุจ ูู ูุนุฑูุฉ ุงููุฒูุฏ",
     "source": "contact_form"
   }
   ```

---

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### 1. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ
```bash
# ุฅุถุงูุฉ API Key ูู .env
PUBLIC_API_KEYS=test_key_12345

# ุชุดุบูู ุงูู Seeder (ุชู โ)
php artisan db:seed --class=WebsiteFormsSourceSeeder
```

### 2. ุงุฎุชุจุงุฑ ุงูู API
```bash
curl -X POST http://localhost:8000/api/public/v1/leads \
  -H "Content-Type: application/json" \
  -H "X-API-Key: test_key_12345" \
  -d '{
    "name": "ุนููู ุชุฌุฑูุจู",
    "phone": "0501234567",
    "email": "test@example.com",
    "subject": "ุงุฎุชุจุงุฑ",
    "message": "ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ",
    "source": "contact_form"
  }'
```

### 3. ุงูุชุญูู ูู ุงููุชูุฌุฉ
- โ ุชุญูู ูู ุฅูุดุงุก ุงูุนููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุชุญูู ูู ุฅุถุงูุฉ ุงูุชุนููู (ุฅุฐุง ูุฌุฏ message/subject)
- โ ุชุญูู ูู ุชูุณูู ุฑูู ุงูุฌูุงู (+966)

---

## ๐ ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ ุงูููุชุฑุญุฉ

### ุงูุฃูุงู
- [ ] **Rate Limiting:** ุชุญุฏูุฏ ุนุฏุฏ ุงูุทูุจุงุช (60/ุฏูููุฉ)
- [ ] **CORS Configuration:** ุฅุถุงูุฉ ูุทุงูุงุช ุงููููุน ุงููุณููุญุฉ
- [ ] **IP Whitelisting:** ุงูุณูุงุญ ููุท ูู IPs ูุญุฏุฏุฉ

### ุงูููุฒุงุช
- [ ] **Webhook Notifications:** ุฅุดุนุงุฑ ููุฑู ุนูุฏ ุชุณุฌูู Lead ุฌุฏูุฏ
- [ ] **Auto-Assignment:** ุฅุณูุงุฏ ุชููุงุฆู ููููุธููู
- [ ] **Lead Scoring:** ุชูููู ุฌูุฏุฉ ุงูู Lead
- [ ] **Duplicate Detection:** ุงูุชุดุงู ุงูุนููุงุก ุงูููุฑุฑูู ุจุฐูุงุก

### ุงูุชุญูููุงุช
- [ ] **Conversion Tracking:** ุชุชุจุน ูุนุฏู ุงูุชุญููู ูู ูู ูููุฐุฌ
- [ ] **Response Time:** ููุงุณ ุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ
- [ ] **Dashboard Widget:** ุนุฑุถ ุงูู Leads ุงูุฌุฏูุฏุฉ ูู Dashboard

---

## ๐ ุงูุฏุนู

ูู ุญุงู ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุฑุงุฌุน `DOCS_PUBLIC_API_INTERNAL.md` (ุงุณุชูุดุงู ุงูุฃุฎุทุงุก)
2. ุชุญูู ูู ุงูู Logs: `storage/logs/laravel.log`
3. ุชูุงุตู ูุน ุงููุฑูู ุงูุชููู

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุฅูุดุงุก **Public API** ูุงูู ููุชูุงูู ูุฑุจุท ููุงุฐุฌ ุงููููุน ุงูุฅููุชุฑููู ูุน ูุธุงู CRM ุจุดูู ุขููุ ูุน:

- โ Backend ูุงูู (Controller, Validation, Middleware)
- โ ุชูุซูู ุดุงูู (ูููุจุฑูุฌ ุงูุฎุงุฑุฌู + ูููุฑูู ุงูุชููู)
- โ ุฃูุซูุฉ ุจุฑูุฌูุฉ (JavaScript, jQuery, React, Vue)
- โ Postman Collection ุฌุงูุฒ ููุงุฎุชุจุงุฑ
- โ ุฃูุงู ูุชูุฏู (API Key, Validation, Error Handling)
- โ Seeder ููุจูุงูุงุช ุงูุฃุณุงุณูุฉ (ุชู ุงูุชุดุบูู)

**ุงูุขู ูููู ูููุจุฑูุฌ ุงูุฎุงุฑุฌู ุงูุจุฏุก ูู ุงูุฑุจุท ูุจุงุดุฑุฉ!** ๐

---

**ุชู ุงูุฅูุฌุงุฒ ุจูุงุณุทุฉ:** Antigravity AI  
**ุงูุชุงุฑูุฎ:** 2026-01-24  
**ุงูููุช ุงููุณุชุบุฑู:** ~15 ุฏูููุฉ  
**ุนุฏุฏ ุงููููุงุช ุงููููุดุฃุฉ:** 8 ูููุงุช
