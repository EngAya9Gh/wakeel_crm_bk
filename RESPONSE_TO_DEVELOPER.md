# ุงูููุถูุน: ุชูุงุตูู ุงูู API ูุฑุจุท ููุงุฐุฌ ุงููููุน ูุน ูุธุงู ุงูู CRM

ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชูุ

ูุดูุฑูู ุนูู ุชูุงุตููู ูุนูุง. ูุณุฑูุง ุชุฒููุฏูู ุจูุงูุฉ ุงูุชูุงุตูู ุงููููุฉ ุงููุงุฒูุฉ ูุฑุจุท ููุงุฐุฌ ุงููููุน ุงูุฅููุชุฑููู ูุน ูุธุงู ุฅุฏุงุฑุฉ ุนูุงูุงุช ุงูุนููุงุก (CRM) ุงูุฎุงุต ุจูุง.

---

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุนูุฏ ุฅุฑุณุงู ุจูุงูุงุช ุงูุนููู ูู ููุงุฐุฌ ุงููููุน (ูููุฐุฌ ุงุชุตู ุจูุง ุฃู ุตูุญุฉ ุงููุจูุท)ุ ุณูุชู ุชุณุฌููู ุชููุงุฆูุงู ูู ูุธุงู CRM ูุนููู ูุญุชูู (Lead) ุฌุงูุฒ ูููุชุงุจุนุฉ ูู ูุจู ูุฑูู ุงููุจูุนุงุช.

---

## ๐ 1. ูุนูููุงุช ุงูู Endpoint

### ุฑุงุจุท ุงูู API
```
POST https://crm.your-domain.com/api/public/v1/leads
```

> **ููุงุญุธุฉ:** ุณูุชู ุชุฒููุฏูู ุจุฑุงุจุท ุงูุฅูุชุงุฌ ุงููุนูู ุนูุฏ ุงูุฌุงูุฒูุฉ.

---

## ๐ 2. ุงููุตุงุฏูุฉ (Authentication)

### API Key

ูุชุทูุจ ูุฐุง ุงูู API ุงุณุชุฎุฏุงู **API Key** ูููุตุงุฏูุฉ. ูุง ูุชุทูุจ ุชุณุฌูู ุฏุฎูู ูุณุชุฎุฏู.

### ุทุฑููุฉ ุฅุฑุณุงู ุงูู API Key

**ุงูุทุฑููุฉ ุงูููุตู ุจูุง (Header):**
```http
X-API-Key: YOUR_API_KEY_HERE
```

**ุฃู ุจุงุณุชุฎุฏุงู Bearer Token:**
```http
Authorization: Bearer YOUR_API_KEY_HERE
```

### ุงูุญุตูู ุนูู API Key

ุณูุชู ุชุฒููุฏูู ุจู **API Key** ุฎุงุต ุจูููุนูู. ูุฑุฌู:
- โ ุญูุธู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ (Environment Variables)
- โ ุนุฏู ูุดุงุฑูุชู ุนููุงู
- โ ุนุฏู ูุถุนู ูู ุงูููุฏ ุงููุฑุฆู ูููุณุชุฎุฏููู (Frontend)

**API Key ุงูุฎุงุต ุจูู:**
```
[ุณูุชู ุฅุฑุณุงูู ุจุดูู ูููุตู ูุขูู]
```

---

## ๐ค 3. ุงูุญููู ุงููุทููุจุฉ (Request Body)

### Content-Type
```
Content-Type: application/json
```

### ุงูุจูุงูุงุช ุงููุทููุจุฉ

| ุงูุญูู | ุงูููุน | ูุทููุจุ | ุงููุตู | ูุซุงู |
|------|------|--------|------|------|
| `name` | string | โ **ูุนู** | ุงูุงุณู ุงููุงูู (3-255 ุญุฑู) | `"ุฃุญูุฏ ูุญูุฏ ุนูู"` |
| `phone` | string | โ **ูุนู** | ุฑูู ุงูุฌูุงู ุจุตูุบุฉ ุณุนูุฏูุฉ | `"0501234567"` ุฃู `"+966501234567"` |
| `source` | string | โ **ูุนู** | ูุตุฏุฑ ุงููููุฐุฌ | `"contact_form"` ุฃู `"landing_page"` |
| `email` | string | โ ูุง | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | `"ahmed@example.com"` |
| `company` | string | โ ูุง | ุงุณู ุงูุดุฑูุฉ | `"ุดุฑูุฉ ุงูุฃูู ููุชุฌุงุฑุฉ"` |
| `address` | string | โ ูุง | ุงูุนููุงู | `"ุงูุฑูุงุถ - ุญู ุงููุฎูู"` |
| `subject` | string | โ ูุง | ุนููุงู/ููุถูุน ุงูุฑุณุงูุฉ | `"ุงุณุชูุณุงุฑ ุนู ุงูุฎุฏูุงุช"` |
| `message` | string | โ ูุง | ูุต ุงูุฑุณุงูุฉ | `"ุฃุฑุบุจ ูู ุงูุงุณุชูุณุงุฑ ุนู..."` |

### ููู ุงูู `source` ุงููุณููุญุฉ:
- `contact_form` - ูููุฐุฌ ุงุชุตู ุจูุง
- `landing_page` - ุตูุญุฉ ุงููุจูุท
- `website_form` - ูููุฐุฌ ุนุงู ูู ุงููููุน

### ููุงุญุธุงุช ูููุฉ:

#### 1. ุฑูู ุงูุฌูุงู:
- โ ูุฏุนู ุฌููุน ุงูุตูุบ ุงูุณุนูุฏูุฉ: `05xxxxxxxx`, `+966xxxxxxxx`, `00966xxxxxxxx`, `966xxxxxxxx`
- โ ุณูุชู ุชุญูููู ุชููุงุฆูุงู ุฅูู ุตูุบุฉ ููุญุฏุฉ (`+966xxxxxxxxx`)
- โ **ูููู ุชุณุฌูู ููุณ ุงูุฑูู ุฃูุซุฑ ูู ูุฑุฉ** (ูุง ููุฌุฏ ููุน ููุชูุฑุงุฑ)

#### 2. ุงููุตุฏุฑ (source):
- โ **ูุทููุจ** ูุชุชุจุน ูุตุฏุฑ ูู ุนููู
- โ ูุณุงุนุฏ ูู ุชุญููู ูุนุงููุฉ ูู ูููุฐุฌ

---

## ๐ฅ 4. ุฃูุซูุฉ ุนูู ุงูุทูุจุงุช

### ูุซุงู 1: ูููุฐุฌ ุงุชุตู ุจูุง (Contact Form)

#### cURL
```bash
curl -X POST https://crm.your-domain.com/api/public/v1/leads \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY_HERE" \
  -d '{
    "name": "ุฃุญูุฏ ูุญูุฏ ุนูู",
    "phone": "0501234567",
    "email": "ahmed@example.com",
    "subject": "ุงุณุชูุณุงุฑ ุนู ุฎุฏูุงุช ุงูุชุณููู",
    "message": "ุฃุฑุบุจ ูู ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุฎุฏูุงุช ุงูุชุณููู ุงูุฑููู ุงููุชููุฑุฉ ูุฏููู",
    "source": "contact_form"
  }'
```

#### JavaScript (Fetch API)
```javascript
const formData = {
  name: document.getElementById('name').value,
  phone: document.getElementById('phone').value,
  email: document.getElementById('email').value,
  subject: document.getElementById('subject').value,
  message: document.getElementById('message').value,
  source: 'contact_form'
};

fetch('https://crm.your-domain.com/api/public/v1/leads', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': 'YOUR_API_KEY_HERE'
  },
  body: JSON.stringify(formData)
})
.then(response => response.json())
.then(data => {
  if (data.success) {
    alert('ุดูุฑุงู ูุชูุงุตูู ูุนูุง! ุณูุชูุงุตู ูุนู ูุฑูุจุงู');
    // ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
    document.getElementById('contactForm').reset();
  } else {
    alert('ุญุฏุซ ุฎุทุฃ: ' + data.message);
  }
})
.catch(error => {
  console.error('Error:', error);
  alert('ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู');
});
```

#### jQuery
```javascript
$.ajax({
  url: 'https://crm.your-domain.com/api/public/v1/leads',
  type: 'POST',
  headers: {
    'X-API-Key': 'YOUR_API_KEY_HERE'
  },
  contentType: 'application/json',
  data: JSON.stringify({
    name: $('#name').val(),
    phone: $('#phone').val(),
    email: $('#email').val(),
    subject: $('#subject').val(),
    message: $('#message').val(),
    source: 'contact_form'
  }),
  success: function(response) {
    if (response.success) {
      alert('ุชู ุฅุฑุณุงู ุฑุณุงูุชู ุจูุฌุงุญ!');
      $('#contactForm')[0].reset();
    }
  },
  error: function(xhr) {
    alert('ุญุฏุซ ุฎุทุฃุ ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู');
  }
});
```

#### PHP (cURL)
```php
<?php
$data = [
    'name' => $_POST['name'],
    'phone' => $_POST['phone'],
    'email' => $_POST['email'],
    'subject' => $_POST['subject'],
    'message' => $_POST['message'],
    'source' => 'contact_form'
];

$ch = curl_init('https://crm.your-domain.com/api/public/v1/leads');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json',
    'X-API-Key: YOUR_API_KEY_HERE'
]);

$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);

$result = json_decode($response, true);

if ($httpCode === 201 && $result['success']) {
    echo "ุชู ุงูุชุณุฌูู ุจูุฌุงุญ!";
} else {
    echo "ุญุฏุซ ุฎุทุฃ: " . $result['message'];
}
?>
```

### ูุซุงู 2: ุตูุญุฉ ุงููุจูุท (Landing Page)

```bash
curl -X POST https://crm.your-domain.com/api/public/v1/leads \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY_HERE" \
  -d '{
    "name": "ุณุงุฑุฉ ุฃุญูุฏ",
    "phone": "+966509876543",
    "email": "sara@company.com",
    "company": "ุดุฑูุฉ ุงููุฌุงุญ",
    "source": "landing_page"
  }'
```

### ูุซุงู 3: ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุจูุงูุงุช

```bash
curl -X POST https://crm.your-domain.com/api/public/v1/leads \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY_HERE" \
  -d '{
    "name": "ูุญูุฏ ุฎุงูุฏ",
    "phone": "0551234567",
    "source": "website_form"
  }'
```

---

## ๐จ 5. ุงูุงุณุชุฌุงุจุงุช ุงููุชููุนุฉ

### โ ูุฌุงุญ ุงูุชุณุฌูู (201 Created)

```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุนููู ุจูุฌุงุญ ูู ุงููุธุงู",
  "data": {
    "lead_id": 125,
    "name": "ุฃุญูุฏ ูุญูุฏ ุนูู",
    "phone": "+966501234567",
    "status": "registered"
  }
}
```

### โ ุฎุทุฃ ูู ุงูุชุญูู ูู ุงูุจูุงูุงุช (422 Unprocessable Entity)

```json
{
  "success": false,
  "message": "ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ",
  "errors": {
    "name": [
      "ุงูุงุณู ูุฌุจ ุฃู ูููู 3 ุฃุญุฑู ุนูู ุงูุฃูู"
    ],
    "phone": [
      "ุฑูู ุงูุฌูุงู ุบูุฑ ุตุญูุญ. ูุฌุจ ุฃู ูุจุฏุฃ ุจู 05 ุฃู +966"
    ],
    "email": [
      "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุญูุญ"
    ]
  }
}
```

### โ API Key ููููุฏ (401 Unauthorized)

```json
{
  "success": false,
  "message": "API Key ูุทููุจ",
  "error": {
    "code": "MISSING_API_KEY",
    "message": "ูุฌุจ ุชุถููู API Key ูู ุงูุทูุจ"
  }
}
```

### โ API Key ุบูุฑ ุตุญูุญ (403 Forbidden)

```json
{
  "success": false,
  "message": "API Key ุบูุฑ ุตุญูุญ",
  "error": {
    "code": "INVALID_API_KEY",
    "message": "ุงูููุชุงุญ ุงูููุฏู ุบูุฑ ุตุงูุญ"
  }
}
```

### โ๏ธ ุชุฌุงูุฒ ุงูุญุฏ ุงููุณููุญ (429 Too Many Requests)

```json
{
  "message": "Too Many Attempts.",
  "exception": "Illuminate\\Http\\Exceptions\\ThrottleRequestsException"
}
```

---

## ๐ข 6. ุฑููุฒ ุงูุญุงูุฉ (HTTP Status Codes)

| ุงูููุฏ | ุงูุญุงูุฉ | ุงููุตู |
|------|--------|------|
| `201` | Created | โ ุชู ุชุณุฌูู ุงูุนููู ุจูุฌุงุญ |
| `400` | Bad Request | โ ุทูุจ ุบูุฑ ุตุญูุญ (JSON ุบูุฑ ุตุงูุญ) |
| `401` | Unauthorized | โ API Key ููููุฏ |
| `403` | Forbidden | โ API Key ุบูุฑ ุตุญูุญ |
| `422` | Unprocessable Entity | โ ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ (validation errors) |
| `429` | Too Many Requests | โ๏ธ ุชุฌุงูุฒ ุงูุญุฏ ุงููุณููุญ ูู ุงูุทูุจุงุช |
| `500` | Internal Server Error | โ ุฎุทุฃ ูู ุงูุฎุงุฏู |

---

## โก 7. ูุนูููุงุช ุฅุถุงููุฉ

### Rate Limiting (ุญุฏ ุงูุทูุจุงุช)

- **ุงูุญุฏ:** **60 ุทูุจ ูู ุงูุฏูููุฉ** ููู API Key
- ุฅุฐุง ุชุฌุงูุฒุชู ุงูุญุฏุ ุณุชุญุตููู ุนูู ุงุณุชุฌุงุจุฉ `429 Too Many Requests`
- ูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ ูู ุฏูููุฉ
- ูููู ุฒูุงุฏุฉ ุงูุญุฏ ุจุงูุชูุณูู ูุนูุง ุฅุฐุง ูุฒู ุงูุฃูุฑ

### ุงูุชุนุงูู ูุน ุงูุฃุฑูุงู ุงูููุฑุฑุฉ

- โ **ูููู ุชุณุฌูู ููุณ ุฑูู ุงูุฌูุงู ุฃูุซุฑ ูู ูุฑุฉ**
- โ ูุง ููุฌุฏ ููุน ููุชูุฑุงุฑ
- โ ูู ุชุณุฌูู ุณูููุดุฆ ุณุฌู ุนููู ุฌุฏูุฏ ูููุตู

### ุจูุฆุฉ ุงูุงุฎุชุจุงุฑ (Sandbox)

**ูุชููุฑุฉ:** ูุนู

**ุงูุฑุงุจุท:**
```
https://staging-crm.your-domain.com/api/public/v1/leads
```

**API Key ููุงุฎุชุจุงุฑ:**
```
[ุณูุชู ุชุฒููุฏูู ุจู]
```

### ุจูุฆุฉ ุงูุฅูุชุงุฌ (Production)

**ุงูุฑุงุจุท:**
```
https://crm.your-domain.com/api/public/v1/leads
```

**API Key ููุฅูุชุงุฌ:**
```
[ุณูุชู ุชุฒููุฏูู ุจู - ูุฎุชูู ุนู ููุชุงุญ ุงูุงุฎุชุจุงุฑ]
```

---

## ๐๏ธ 8. ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "API Key ูุทููุจ"

**ุงูุญู:**
- โ ุชุฃูุฏูุง ูู ุฅุฑุณุงู ุงูู API Key ูู ุงูู Header: `X-API-Key: your_key`
- โ ุชุญูููุง ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช ุฒุงุฆุฏุฉ ูู ุงูู Key

### ุงููุดููุฉ: "ุฑูู ุงูุฌูุงู ุบูุฑ ุตุญูุญ"

**ุงูุญู:**
- โ ุชุฃูุฏูุง ูู ุฃู ุงูุฑูู ุจุตูุบุฉ ุณุนูุฏูุฉ ุตุญูุญุฉ
- โ ุฃูุซูุฉ ุตุญูุญุฉ: `0501234567`, `+966501234567`, `00966501234567`

### ุงููุดููุฉ: CORS Error (ูู ุงููุชุตูุญ)

**ุงูุญู:**
- โ ุชูุงุตููุง ูุนูุง ูุฅุถุงูุฉ ูุทุงู ูููุนูู ุฅูู ูุงุฆูุฉ ุงูู CORS ุงููุณููุญุฉ
- โ ุณูุถูู: `Access-Control-Allow-Origin: https://your-website.com`

### ุงููุดููุฉ: "Too Many Requests" (429)

**ุงูุญู:**
- โ ุชุฌุงูุฒุชู ุญุฏ ุงูู 60 ุทูุจ ูู ุงูุฏูููุฉ
- โ ุงูุชุธุฑูุง ุฏูููุฉ ูุงุญุฏุฉ ุซู ุญุงูููุง ูุฑุฉ ุฃุฎุฑู
- โ ุฅุฐุง ููุชู ุจุญุงุฌุฉ ูุญุฏ ุฃุนููุ ุชูุงุตููุง ูุนูุง

---

## ๐ 9. ููุงุญุธุงุช ูููุฉ

### ุงูุฃูุงู:
1. โ **ูุง ุชุดุงุฑููุง ุงูู API Key ุนููุงู**
2. โ **ูุง ุชุถุนูู ูู ุงูููุฏ ุงููุฑุฆู ูููุณุชุฎุฏููู (Frontend)**
3. โ **ุงุณุชุฎุฏููุง Server-Side Processing ูุฅุฑุณุงู ุงูุจูุงูุงุช**
4. โ **ุงุณุชุฎุฏููุง HTTPS ููุท ูู ุงูุฅูุชุงุฌ**

### ุงูุฃุฏุงุก:
1. โ ูููุถู ุฅุฑุณุงู ุงูุทูุจุงุช ุจุดูู ุบูุฑ ูุชุฒุงูู (Asynchronous)
2. โ ูุง ุชูุชุธุฑูุง ุงูุงุณุชุฌุงุจุฉ ูุฅุธูุงุฑ ุฑุณุงูุฉ ูููุณุชุฎุฏู (ุงุณุชุฎุฏููุง AJAX)
3. โ ุงุญุชูุธูุง ุจู `lead_id` ุงูููุฑุฌุน ูุชุชุจุน ุงูุนููู ูุงุญูุงู

### ุงูุชุชุจุน:
1. โ ุงุญุชูุธูุง ุจู `lead_id` ูู ุงูุงุณุชุฌุงุจุฉ
2. โ ูููู ุงุณุชุฎุฏุงูู ููุงุณุชุนูุงู ุนู ุญุงูุฉ ุงูุนููู ูุงุญูุงู
3. โ ุณุฌููุง ุงูุฃุฎุทุงุก ูู ูุธุงููู ูููุฑุงุฌุนุฉ

---

## ๐ 10. ุงูุฏุนู ุงูููู

ูู ุญุงู ูุงุฌูุชู ุฃู ูุดููุฉ ุฃู ูุฏููู ุงุณุชูุณุงุฑ:

- **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:** support@crm-wakeel.com
- **ุงููุงุชู:** +966 XX XXX XXXX
- **ุณุงุนุงุช ุงูุนูู:** ุงูุฃุญุฏ - ุงูุฎููุณ (9 ุตุจุงุญุงู - 5 ูุณุงุกู)

---

## โ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ูุฑุงุฌุนุฉ ุงูุชูุซูู:** ุชุฃูุฏูุง ูู ููู ุฌููุน ุงูุชูุงุตูู ุฃุนูุงู
2. **ุงุณุชูุงู API Keys:** ุณูุฑุณู ููู ุงูููุงุชูุญ ุจุดูู ูููุตู ูุขูู
3. **ุงูุงุฎุชุจุงุฑ:** ุงุจุฏุฃูุง ุจุงูุงุฎุชุจุงุฑ ุนูู ุจูุฆุฉ Staging
4. **ุงูุชูุงูู:** ููููุง ุจุฑุจุท ุงูููุงุฐุฌ ูุน ุงูู API
5. **ุงูุฅุทูุงู:** ุจุนุฏ ุงูุชุฃูุฏ ูู ุนูู ูู ุดูุกุ ุงูุชูููุง ููุฅูุชุงุฌ

---

## ๐ ูุฑููุงุช

ุณูุฑุณู ููู ุงููุฑููุงุช ุงูุชุงููุฉ ุจุดูู ูููุตู:
- โ API Keys (Staging & Production)
- โ Postman Collection (ุงุฎุชูุงุฑู)
- โ ุฃูุซูุฉ ุจุฑูุฌูุฉ ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)

---

ูุชุทูุน ููุนูู ูุนูู ููุชููู ููู ุงูุชูููู ูู ุงูุชูุงูู!

**ูุฑูู CRM Wakeel**  
**ุงูุชุงุฑูุฎ:** 2026-01-24
