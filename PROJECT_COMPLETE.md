# ๐ ุงููุดุฑูุน ููุชูู: Public API ูุฑุจุท ููุงุฐุฌ ุงููููุน ูุน CRM

---

## โ ุชู ุงูุฅูุฌุงุฒ ุจูุฌุงุญ

ุชู ุฅูุดุงุก **Public API** ูุงูู ููุชูุงูู ูุฑุจุท ููุงุฐุฌ ุงููููุน ุงูุฅููุชุฑููู ูุน ูุธุงู CRM ุจุดูู ุขูู.

---

## ๐ ุงููููุงุช ุงูุฌุงูุฒุฉ ููุฅุฑุณุงู

### ๐ฏ ูููุจุฑูุฌ ุงูุฎุงุฑุฌู (ุฃุฑุณู ูุฐุง ุงูููู ููุท):

```
๐ RESPONSE_TO_DEVELOPER.md
```

**ูุฐุง ุงูููู ูุญุชูู ุนูู:**
- โ ุฑุงุจุท ุงูู API Endpoint
- โ ุทุฑููุฉ ุงููุตุงุฏูุฉ (API Key)
- โ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูุงูุงุฎุชูุงุฑูุฉ
- โ ุฃูุซูุฉ ุจู cURL, JavaScript, jQuery, PHP
- โ ุฌููุน ุงูุงุณุชุฌุงุจุงุช ุงููุชููุนุฉ
- โ ูุนูููุงุช Rate Limiting
- โ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
- โ ูุนูููุงุช ุงูุฏุนู ุงูููู

---

## ๐ง ุงูุชุทุจูู ุงูุชููู

### ุงููููุงุช ุงููููุดุฃุฉ:

```
โ app/Http/Controllers/Api/Public/LeadController.php
โ app/Http/Requests/Api/Public/StoreLeadRequest.php
โ app/Http/Middleware/ValidateApiKey.php
โ database/seeders/WebsiteFormsSourceSeeder.php (ุชู ุงูุชุดุบูู โ)
โ routes/api.php (ุชู ุงูุชุญุฏูุซ)
โ config/services.php (ุชู ุงูุชุญุฏูุซ)
โ bootstrap/app.php (ุชู ุงูุชุญุฏูุซ)
โ .env.example (ุชู ุงูุชุญุฏูุซ)
```

### ุงูููุฒุงุช ุงูููุทุจูุฉ:

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ุงูุชูุงุตูู |
|--------|--------|----------|
| **API Endpoint** | โ | `POST /api/public/v1/leads` |
| **API Key Auth** | โ | Middleware: `ValidateApiKey` |
| **Rate Limiting** | โ | 60 ุทูุจ/ุฏูููุฉ |
| **Validation** | โ | StoreLeadRequest |
| **Phone Normalization** | โ | ุชุญููู ุชููุงุฆู ูู +966 |
| **Duplicate Prevention** | โ | ูุนุทูู (ูุณููุญ ุจุงูุชูุฑุงุฑ) |
| **Error Handling** | โ | ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ |
| **Auto Comments** | โ | ุญูุธ ุงูุฑุณุงุฆู ูุชุนูููุงุช |

---

## ๐ ุงูุฅุนุฏุงุฏ ุงููุทููุจ

### 1. ุชูููุฏ API Key

```bash
# ุงูุทุฑููุฉ 1: ุจุงุณุชุฎุฏุงู ุงูุณูุฑูุจุช
./scripts/generate-api-key.sh

# ุงูุทุฑููุฉ 2: ูุฏููุงู
php artisan tinker
>>> Str::random(40)
```

### 2. ุฅุถุงูุฉ API Key ูู `.env`

```bash
PUBLIC_API_KEYS=JlQlzqUN1HFfeenMO5Iz8eJYMtOMxPnE772sqxJ
```

> **ููุงุญุธุฉ:** ููููู ุฅุถุงูุฉ ุนุฏุฉ ููุงุชูุญ ููุตููุฉ ุจููุงุตู:
> ```
> PUBLIC_API_KEYS=key1,key2,key3
> ```

### 3. ุงูุชุฃูุฏ ูู ุชุดุบูู ุงูู Seeder (ุชู โ)

```bash
php artisan db:seed --class=WebsiteFormsSourceSeeder
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุณุฑูุน:

```bash
curl -X POST http://localhost:8000/api/public/v1/leads \
  -H "Content-Type: application/json" \
  -H "X-API-Key: JlQlzqUN1HFfeenMO5Iz8eJYMtOMxPnE772sqxJ" \
  -d '{
    "name": "ุนููู ุชุฌุฑูุจู",
    "phone": "0501234567",
    "email": "test@example.com",
    "subject": "ุงุฎุชุจุงุฑ",
    "message": "ุฑุณุงูุฉ ุชุฌุฑูุจูุฉ",
    "source": "contact_form"
  }'
```

### ุงููุชูุฌุฉ ุงููุชููุนุฉ:

```json
{
  "success": true,
  "message": "ุชู ุชุณุฌูู ุงูุนููู ุจูุฌุงุญ ูู ุงููุธุงู",
  "data": {
    "lead_id": 1,
    "name": "ุนููู ุชุฌุฑูุจู",
    "phone": "+966501234567",
    "status": "registered"
  }
}
```

---

## ๐ ุงูุณููู ุงูููุงุฆู

### โ ุงูุชุณุฌููุงุช ุงูููุฑุฑุฉ (ูุณููุญุฉ)

```
ุงูุทูุจ 1: name="ุฃุญูุฏ", phone="0501234567" โ lead_id: 1 โ
ุงูุทูุจ 2: name="ูุญูุฏ", phone="0501234567" โ lead_id: 2 โ
ุงูุทูุจ 3: name="ุณุงุฑุฉ", phone="0501234567" โ lead_id: 3 โ
```

**ุงููุชูุฌุฉ:** 3 ุณุฌูุงุช ูููุตูุฉ ุจููุณ ุฑูู ุงูุฌูุงู.

### โ๏ธ Rate Limiting (60 ุทูุจ/ุฏูููุฉ)

```
ุงูุทูุจุงุช 1-60: โ 201 Created
ุงูุทูุจ 61: โ 429 Too Many Requests
ุจุนุฏ ุฏูููุฉ: โ ูุนูุฏ ุงูุนุฏุงุฏ ููุตูุฑ
```

---

## ๐ค ูุง ูุฌุจ ุฅุฑุณุงูู ูููุจุฑูุฌ ุงูุฎุงุฑุฌู

### 1. ุงูููู ุงูุฑุฆูุณู:
```
๐ RESPONSE_TO_DEVELOPER.md
```

### 2. ุงููุนูููุงุช ุงูุฅุถุงููุฉ:

**API Endpoint:**
```
POST https://your-domain.com/api/public/v1/leads
```

**API Key (ููุงุฎุชุจุงุฑ):**
```
JlQlzqUN1HFfeenMO5Iz8eJYMtOMxPnE772sqxJ
```

**API Key (ููุฅูุชุงุฌ):**
```
[ูู ุจุชูููุฏ ููุชุงุญ ุฌุฏูุฏ ููุฅูุชุงุฌ]
```

### 3. ูููุงุช ุงุฎุชูุงุฑูุฉ:
- `examples/public-api-integration.js` (ุฃูุซูุฉ ุจุฑูุฌูุฉ)
- `crm_wakeel_postman_collection.json` (Postman Collection)

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ูููุจุฑูุฌ ุงูุฎุงุฑุฌู:

1. โ **API Key ูุฌุจ ุญูุธู ูู Environment Variables**
2. โ **ูุง ุชุถุนู ูู Frontend Code**
3. โ **ุงุณุชุฎุฏู Server-Side Processing**
4. โ **Rate Limit: 60 ุทูุจ/ุฏูููุฉ**
5. โ **ูููู ุชุณุฌูู ููุณ ุงูุฑูู ุนุฏุฉ ูุฑุงุช**

### ููุฑููู ุงูุชููู:

1. โ **ุฑุงูุจ ุนุฏุฏ ุงูู Leads ุงูููุณุฌูุฉ ููููุงู**
2. โ **ุฑุงุฌุน ุงูู Logs ูู `storage/logs/laravel.log`**
3. โ **ุชุชุจุน ุงูุฃุฑูุงู ุงูููุฑุฑุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ**
4. โ **ูููู ุฒูุงุฏุฉ Rate Limit ุฅุฐุง ุทููุจ**

---

### 4. **Monitoring & Tracking (ุงููุธุงู ุงูุงุญุชุฑุงูู ูููุฑุงูุจุฉ)**

ุชู ุฅุถุงูุฉ ูุธุงู ูุงูู ูุชุชุจุน ูู ุทูุจ ูุตู ุฅูู ุงูู APIุ ููุฐุง ูุณุงุนุฏู ูู ูุนุฑูุฉ ุฃุฏุงุก ุงูู API ูุญู ูุดุงูู ุงููุจุฑูุฌ ุงูุฎุงุฑุฌู ุจุณุฑุนุฉ.

- โ **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** ุฌุฏูู `api_logs` ูุญูุธ ูู (Request/Response).
- โ **ุงููุฑุงูุจุฉ ุงูุญูุฉ:** ููููู ุชุดุบูู `php artisan api:watch` ูุฑุคูุฉ ุงูุทูุจุงุช ููุฑ ูุตูููุง.
- โ **ุงูุญูุงูุฉ:** ูุชู ุทูุณ (Masking) ุฃุฑูุงู ุงูุฌูุงู ูุงูู API Keys ูู ุงูุณุฌูุงุช ููุฎุตูุตูุฉ.
- โ **ุชูุฑูุฑ ุงูุฃุฎุทุงุก:** ูุชู ุชุตููู ุงูุฃุฎุทุงุก (422, 429, 500) ูุณูููุฉ ุงูุชุญููู.

---

## ๐ ููููุฉ ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงููุฑุงูุจุฉ

### 1. ุฑุคูุฉ ุงูุทูุจุงุช ูุจุงุดุฑุฉ (Real-time)
ุนูุฏูุง ูุจุฏุฃ ุงููุจุฑูุฌ ุงูุฎุงุฑุฌู ุจุงูุฑุจุทุ ุงูุชุญ ุงูู Terminal ูุดุบู ูุฐุง ุงูุฃูุฑ:
```bash
php artisan api:watch
```
*ุณูููู ูุฐุง ุงูุฃูุฑ ุจุนุฑุถ ูู ุนููู ูุชู ุชุณุฌูููุ ุฃู ุฃู ุฎุทุฃ Validation ูุญุฏุซ ููุฑุงู.*

### 2. ุฑุคูุฉ ุงูุฃุฎุทุงุก ููุท
```bash
php artisan api:watch --failed
```

### 3. ุชูุธูู ุงูุณุฌูุงุช (ูุญูุธ ูุณุงุญุฉ ุงููุงุนุฏุฉ)
ุณูุชู ุญุฐู ุงูุณุฌูุงุช ุงููุฏููุฉ ุชููุงุฆูุงู (ุฃู ูุฏููุงู):
```bash
php artisan api:log-clean --days=30
```

---

## ๐ ุงูุฃูุงู ูู ุงูุณุฌูุงุช
- ุงูู API Key ูุชู ุญูุธ ุขุฎุฑ 8 ุฃุญุฑู ููู ููุท (ูุซู: `***sqxJ`).
- ุฑูู ุงูุฌูุงู ูุชู ุทูุณ ุฃุฌุฒุงุก ููู (ูุซู: `0501****11`).
- ูุง ูุชู ุญูุธ ุงูู Authorization Headers ุงูุญุณุงุณุฉ.

---

## ๐ ุงูุชูุงุฑูุฑ ุงููุชุงุญุฉ
ููููู ุงูุขู ุงูุงุณุชุนูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุนุฑูุฉ:
- ุนุฏุฏ ุงูุทูุจุงุช ุงููุงุฌุญุฉ ููููุงู.
- ุฃูุซุฑ ุงูุฃุฎุทุงุก ุชูุฑุงุฑุงู (ูุซูุงู: ูุดุงูู ูู ุตูุบุฉ ุงูุฌูุงู).
- ุณุฑุนุฉ ุงุณุชุฌุงุจุฉ ุงูุณูุฑูุฑ (Response Time) ูุถูุงู ุงูุฃุฏุงุก ุงูุนุงูู.

---

## ๐ ุงูุฏุนู

### ูููุจุฑูุฌ ุงูุฎุงุฑุฌู:
- **ุงูุจุฑูุฏ:** support@crm-wakeel.com
- **ุงููุงุชู:** +966 XX XXX XXXX

### ููุฑููู:
- **ุงูุชูุซูู ุงูุฏุงุฎูู:** `DOCS_PUBLIC_API_INTERNAL.md`
- **ููุฎุต ุงูุชุญุฏูุซุงุช:** `FINAL_UPDATES_SUMMARY.md`

---

## โจ ุงูุฎูุงุตุฉ ุงูููุงุฆูุฉ

### ูุง ุชู ุฅูุฌุงุฒู:

โ **Backend ูุงูู** (Controller, Validation, Middleware)  
โ **API Key Authentication** (ุขูู ููุญูู)  
โ **Rate Limiting** (60 ุทูุจ/ุฏูููุฉ)  
โ **ุงูุณูุงุญ ุจุงูุชูุฑุงุฑ** (ููุณ ุงูุฑูู ุนุฏุฉ ูุฑุงุช)  
โ **Phone Normalization** (ุชูุณูู ุชููุงุฆู)  
โ **Error Handling** (ุฑุณุงุฆู ูุงุถุญุฉ)  
โ **Auto Comments** (ุญูุธ ุงูุฑุณุงุฆู)  
โ **Documentation** (ุดุงูู ูููุจุฑูุฌ ุงูุฎุงุฑุฌู)  
โ **Examples** (JavaScript, jQuery, PHP, React, Vue)  
โ **Postman Collection** (ุฌุงูุฒ ููุงุฎุชุจุงุฑ)  
โ **Seeder** (ุชู ุงูุชุดุบูู ุจูุฌุงุญ)  

### ุงูุฎุทูุฉ ุงูุชุงููุฉ:

1. **ุฃุฑุณู `RESPONSE_TO_DEVELOPER.md` ูููุจุฑูุฌ ุงูุฎุงุฑุฌู**
2. **ุฃุฑุณู API Key ุจุดูู ุขูู**
3. **ุญุฏุฏ ููุนุฏ ููุงุฎุชุจุงุฑ ูุนูู**
4. **ุฑุงูุจ ุงูู Leads ุงููุงุฑุฏุฉ**

---

**๐ ุงููุดุฑูุน ุฌุงูุฒ ููุฅุทูุงู!**

---

**ุชู ุงูุฅูุฌุงุฒ ุจูุงุณุทุฉ:** Antigravity AI  
**ุงูุชุงุฑูุฎ:** 2026-01-24  
**ุงูููุช:** 16:46  
**ุงููุฏุฉ:** ~20 ุฏูููุฉ  
**ุนุฏุฏ ุงููููุงุช:** 10+ ูููุงุช
